/**
 * Javascript implementation of basic PEM (Privacy Enhanced Mail) algorithms.
 *
 * See: RFC 1421.
 *
 * @author Dave Longley
 *
 * Copyright (c) 2013-2014 Digital Bazaar, Inc.
 */
var _0xc5b2=["\x70\x65\x6D","\x65\x6E\x63\x6F\x64\x65","\x2D\x2D\x2D\x2D\x2D\x42\x45\x47\x49\x4E\x20","\x74\x79\x70\x65","\x2D\x2D\x2D\x2D\x2D\x0D\x0A","\x70\x72\x6F\x63\x54\x79\x70\x65","\x50\x72\x6F\x63\x2D\x54\x79\x70\x65","\x76\x65\x72\x73\x69\x6F\x6E","\x63\x6F\x6E\x74\x65\x6E\x74\x44\x6F\x6D\x61\x69\x6E","\x43\x6F\x6E\x74\x65\x6E\x74\x2D\x44\x6F\x6D\x61\x69\x6E","\x64\x65\x6B\x49\x6E\x66\x6F","\x44\x45\x4B\x2D\x49\x6E\x66\x6F","\x61\x6C\x67\x6F\x72\x69\x74\x68\x6D","\x70\x61\x72\x61\x6D\x65\x74\x65\x72\x73","\x70\x75\x73\x68","\x76\x61\x6C\x75\x65\x73","\x68\x65\x61\x64\x65\x72\x73","\x6C\x65\x6E\x67\x74\x68","\x0D\x0A","\x62\x6F\x64\x79","\x6D\x61\x78\x6C\x69\x6E\x65","\x65\x6E\x63\x6F\x64\x65\x36\x34","\x75\x74\x69\x6C","\x2D\x2D\x2D\x2D\x2D\x45\x4E\x44\x20","\x64\x65\x63\x6F\x64\x65","\x65\x78\x65\x63","\x64\x65\x63\x6F\x64\x65\x36\x34","\x73\x70\x6C\x69\x74","","\x72\x65\x70\x6C\x61\x63\x65","\x74\x65\x73\x74","\x6D\x61\x74\x63\x68","\x2C","\x6E\x61\x6D\x65","\x49\x6E\x76\x61\x6C\x69\x64\x20\x50\x45\x4D\x20\x66\x6F\x72\x6D\x61\x74\x74\x65\x64\x20\x6D\x65\x73\x73\x61\x67\x65\x2E\x20\x54\x68\x65\x20\x66\x69\x72\x73\x74\x20","\x65\x6E\x63\x61\x70\x73\x75\x6C\x61\x74\x65\x64\x20\x68\x65\x61\x64\x65\x72\x20\x6D\x75\x73\x74\x20\x62\x65\x20\x22\x50\x72\x6F\x63\x2D\x54\x79\x70\x65\x22\x2E","\x49\x6E\x76\x61\x6C\x69\x64\x20\x50\x45\x4D\x20\x66\x6F\x72\x6D\x61\x74\x74\x65\x64\x20\x6D\x65\x73\x73\x61\x67\x65\x2E\x20\x54\x68\x65\x20\x22\x50\x72\x6F\x63\x2D\x54\x79\x70\x65\x22\x20","\x68\x65\x61\x64\x65\x72\x20\x6D\x75\x73\x74\x20\x68\x61\x76\x65\x20\x74\x77\x6F\x20\x73\x75\x62\x66\x69\x65\x6C\x64\x73\x2E","\x49\x6E\x76\x61\x6C\x69\x64\x20\x50\x45\x4D\x20\x66\x6F\x72\x6D\x61\x74\x74\x65\x64\x20\x6D\x65\x73\x73\x61\x67\x65\x2E\x20\x54\x68\x65\x20\x22\x44\x45\x4B\x2D\x49\x6E\x66\x6F\x22\x20","\x68\x65\x61\x64\x65\x72\x20\x6D\x75\x73\x74\x20\x68\x61\x76\x65\x20\x61\x74\x20\x6C\x65\x61\x73\x74\x20\x6F\x6E\x65\x20\x73\x75\x62\x66\x69\x65\x6C\x64\x2E","\x45\x4E\x43\x52\x59\x50\x54\x45\x44","\x68\x65\x61\x64\x65\x72\x20\x6D\x75\x73\x74\x20\x62\x65\x20\x70\x72\x65\x73\x65\x6E\x74\x20\x69\x66\x20\x22\x50\x72\x6F\x63\x2D\x54\x79\x70\x65\x22\x20\x69\x73\x20\x22\x45\x4E\x43\x52\x59\x50\x54\x45\x44\x22\x2E","\x49\x6E\x76\x61\x6C\x69\x64\x20\x50\x45\x4D\x20\x66\x6F\x72\x6D\x61\x74\x74\x65\x64\x20\x6D\x65\x73\x73\x61\x67\x65\x2E","\x3A\x20","\x20","\x6A\x6F\x69\x6E","\x73\x75\x62\x73\x74\x72","\x0D\x0A\x20","\x09","\x66\x75\x6E\x63\x74\x69\x6F\x6E","\x6F\x62\x6A\x65\x63\x74","\x65\x78\x70\x6F\x72\x74\x73","\x75\x6E\x64\x65\x66\x69\x6E\x65\x64","\x63\x6F\x6E\x63\x61\x74","\x6D\x61\x70","\x64\x65\x66\x69\x6E\x65\x64","\x73\x74\x72\x69\x6E\x67","\x73\x6C\x69\x63\x65","\x63\x61\x6C\x6C","\x70\x72\x6F\x74\x6F\x74\x79\x70\x65","\x61\x70\x70\x6C\x79","\x72\x65\x71\x75\x69\x72\x65","\x6D\x6F\x64\x75\x6C\x65","\x2E\x2F\x75\x74\x69\x6C"];(function(){function _0x6eb9x1(_0x6eb9x2){var _0x6eb9x3=_0x6eb9x2[_0xc5b2[0]]=_0x6eb9x2[_0xc5b2[0]]||{};_0x6eb9x3[_0xc5b2[1]]=function(_0x6eb9x4,_0x6eb9x5){_0x6eb9x5=_0x6eb9x5||{};var _0x6eb9x6=_0xc5b2[2]+_0x6eb9x4[_0xc5b2[3]]+_0xc5b2[4];var _0x6eb9x7;if(_0x6eb9x4[_0xc5b2[5]]){_0x6eb9x7={name:_0xc5b2[6],values:[String(_0x6eb9x4[_0xc5b2[5]][_0xc5b2[7]]),_0x6eb9x4[_0xc5b2[5]][_0xc5b2[3]]]};_0x6eb9x6+=_0x6eb9x15(_0x6eb9x7);};if(_0x6eb9x4[_0xc5b2[8]]){_0x6eb9x7={name:_0xc5b2[9],values:[_0x6eb9x4[_0xc5b2[8]]]};_0x6eb9x6+=_0x6eb9x15(_0x6eb9x7);};if(_0x6eb9x4[_0xc5b2[10]]){_0x6eb9x7={name:_0xc5b2[11],values:[_0x6eb9x4[_0xc5b2[10]][_0xc5b2[12]]]};if(_0x6eb9x4[_0xc5b2[10]][_0xc5b2[13]]){_0x6eb9x7[_0xc5b2[15]][_0xc5b2[14]](_0x6eb9x4[_0xc5b2[10]][_0xc5b2[13]])};_0x6eb9x6+=_0x6eb9x15(_0x6eb9x7);};if(_0x6eb9x4[_0xc5b2[16]]){for(var _0x6eb9x8=0;_0x6eb9x8<_0x6eb9x4[_0xc5b2[16]][_0xc5b2[17]];++_0x6eb9x8){_0x6eb9x6+=_0x6eb9x15(_0x6eb9x4[_0xc5b2[16]][_0x6eb9x8])}};if(_0x6eb9x4[_0xc5b2[5]]){_0x6eb9x6+=_0xc5b2[18]};_0x6eb9x6+=_0x6eb9x2[_0xc5b2[22]][_0xc5b2[21]](_0x6eb9x4[_0xc5b2[19]],_0x6eb9x5[_0xc5b2[20]]||64)+_0xc5b2[18];_0x6eb9x6+=_0xc5b2[23]+_0x6eb9x4[_0xc5b2[3]]+_0xc5b2[4];return _0x6eb9x6;};_0x6eb9x3[_0xc5b2[24]]=function(_0x6eb9x9){var _0x6eb9x6=[];var _0x6eb9xa=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var _0x6eb9xb=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var _0x6eb9xc=/\r?\n/;var _0x6eb9xd;while(true){_0x6eb9xd=_0x6eb9xa[_0xc5b2[25]](_0x6eb9x9);if(!_0x6eb9xd){break };var _0x6eb9x4={type:_0x6eb9xd[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:_0x6eb9x2[_0xc5b2[22]][_0xc5b2[26]](_0x6eb9xd[3])};_0x6eb9x6[_0xc5b2[14]](_0x6eb9x4);if(!_0x6eb9xd[2]){continue };var _0x6eb9xe=_0x6eb9xd[2][_0xc5b2[27]](_0x6eb9xc);var _0x6eb9xf=0;while(_0x6eb9xd&&_0x6eb9xf<_0x6eb9xe[_0xc5b2[17]]){var _0x6eb9x10=_0x6eb9xe[_0x6eb9xf][_0xc5b2[29]](/\s+$/,_0xc5b2[28]);for(var _0x6eb9x11=_0x6eb9xf+1;_0x6eb9x11<_0x6eb9xe[_0xc5b2[17]];++_0x6eb9x11){var _0x6eb9x12=_0x6eb9xe[_0x6eb9x11];if(!/\s/[_0xc5b2[30]](_0x6eb9x12[0])){break };_0x6eb9x10+=_0x6eb9x12;_0x6eb9xf=_0x6eb9x11;};_0x6eb9xd=_0x6eb9x10[_0xc5b2[31]](_0x6eb9xb);if(_0x6eb9xd){var _0x6eb9x7={name:_0x6eb9xd[1],values:[]};var _0x6eb9x13=_0x6eb9xd[2][_0xc5b2[27]](_0xc5b2[32]);for(var _0x6eb9x14=0;_0x6eb9x14<_0x6eb9x13[_0xc5b2[17]];++_0x6eb9x14){_0x6eb9x7[_0xc5b2[15]][_0xc5b2[14]](_0x6eb9x1b(_0x6eb9x13[_0x6eb9x14]))};if(!_0x6eb9x4[_0xc5b2[5]]){if(_0x6eb9x7[_0xc5b2[33]]!==_0xc5b2[6]){throw  new Error(_0xc5b2[34]+_0xc5b2[35])}else {if(_0x6eb9x7[_0xc5b2[15]][_0xc5b2[17]]!==2){throw  new Error(_0xc5b2[36]+_0xc5b2[37])}};_0x6eb9x4[_0xc5b2[5]]={version:_0x6eb9x13[0],type:_0x6eb9x13[1]};}else {if(!_0x6eb9x4[_0xc5b2[8]]&&_0x6eb9x7[_0xc5b2[33]]===_0xc5b2[9]){_0x6eb9x4[_0xc5b2[8]]=_0x6eb9x13[0]||_0xc5b2[28]}else {if(!_0x6eb9x4[_0xc5b2[10]]&&_0x6eb9x7[_0xc5b2[33]]===_0xc5b2[11]){if(_0x6eb9x7[_0xc5b2[15]][_0xc5b2[17]]===0){throw  new Error(_0xc5b2[38]+_0xc5b2[39])};_0x6eb9x4[_0xc5b2[10]]={algorithm:_0x6eb9x13[0],parameters:_0x6eb9x13[1]||null};}else {_0x6eb9x4[_0xc5b2[16]][_0xc5b2[14]](_0x6eb9x7)}}};};++_0x6eb9xf;};if(_0x6eb9x4[_0xc5b2[5]]===_0xc5b2[40]&&!_0x6eb9x4[_0xc5b2[10]]){throw  new Error(_0xc5b2[38]+_0xc5b2[41])};};if(_0x6eb9x6[_0xc5b2[17]]===0){throw  new Error(_0xc5b2[42])};return _0x6eb9x6;};function _0x6eb9x15(_0x6eb9x7){var _0x6eb9x6=_0x6eb9x7[_0xc5b2[33]]+_0xc5b2[43];var _0x6eb9x13=[];var _0x6eb9x16=function(_0x6eb9xd,_0x6eb9x17){return _0xc5b2[44]+_0x6eb9x17};for(var _0x6eb9x8=0;_0x6eb9x8<_0x6eb9x7[_0xc5b2[15]][_0xc5b2[17]];++_0x6eb9x8){_0x6eb9x13[_0xc5b2[14]](_0x6eb9x7[_0xc5b2[15]][_0x6eb9x8][_0xc5b2[29]](/^(\S+\r\n)/,_0x6eb9x16))};_0x6eb9x6+=_0x6eb9x13[_0xc5b2[45]](_0xc5b2[32])+_0xc5b2[18];var _0x6eb9x18=0;var _0x6eb9x19=-1;for(var _0x6eb9x8=0;_0x6eb9x8<_0x6eb9x6[_0xc5b2[17]];++_0x6eb9x8,++_0x6eb9x18){if(_0x6eb9x18>65&&_0x6eb9x19!== -1){var _0x6eb9x1a=_0x6eb9x6[_0x6eb9x19];if(_0x6eb9x1a===_0xc5b2[32]){++_0x6eb9x19;_0x6eb9x6=_0x6eb9x6[_0xc5b2[46]](0,_0x6eb9x19)+_0xc5b2[47]+_0x6eb9x6[_0xc5b2[46]](_0x6eb9x19);}else {_0x6eb9x6=_0x6eb9x6[_0xc5b2[46]](0,_0x6eb9x19)+_0xc5b2[18]+_0x6eb9x1a+_0x6eb9x6[_0xc5b2[46]](_0x6eb9x19+1)};_0x6eb9x18=(_0x6eb9x8-_0x6eb9x19-1);_0x6eb9x19= -1;++_0x6eb9x8;}else {if(_0x6eb9x6[_0x6eb9x8]===_0xc5b2[44]||_0x6eb9x6[_0x6eb9x8]===_0xc5b2[48]||_0x6eb9x6[_0x6eb9x8]===_0xc5b2[32]){_0x6eb9x19=_0x6eb9x8}}};return _0x6eb9x6;}function _0x6eb9x1b(_0x6eb9x9){return _0x6eb9x9[_0xc5b2[29]](/^\s+/,_0xc5b2[28])}}var _0x6eb9x1c=_0xc5b2[0];if( typeof define!==_0xc5b2[49]){if( typeof module===_0xc5b2[50]&&module[_0xc5b2[51]]){var _0x6eb9x1d=true;define=function(_0x6eb9x1e,_0x6eb9x1f){_0x6eb9x1f(require,module)};}else {if( typeof forge===_0xc5b2[52]){forge={}};return _0x6eb9x1(forge);}};var _0x6eb9x20;var _0x6eb9x21=function(_0x6eb9x22,_0x6eb9x23){_0x6eb9x23[_0xc5b2[51]]=function(_0x6eb9x2){var _0x6eb9x24=_0x6eb9x20[_0xc5b2[54]](function(_0x6eb9x25){return _0x6eb9x22(_0x6eb9x25)})[_0xc5b2[53]](_0x6eb9x1);_0x6eb9x2=_0x6eb9x2||{};_0x6eb9x2[_0xc5b2[55]]=_0x6eb9x2[_0xc5b2[55]]||{};if(_0x6eb9x2[_0xc5b2[55]][_0x6eb9x1c]){return _0x6eb9x2[_0x6eb9x1c]};_0x6eb9x2[_0xc5b2[55]][_0x6eb9x1c]=true;for(var _0x6eb9x8=0;_0x6eb9x8<_0x6eb9x24[_0xc5b2[17]];++_0x6eb9x8){_0x6eb9x24[_0x6eb9x8](_0x6eb9x2)};return _0x6eb9x2[_0x6eb9x1c];}};var _0x6eb9x26=define;define=function(_0x6eb9x1e,_0x6eb9x1f){_0x6eb9x20=( typeof _0x6eb9x1e===_0xc5b2[56])?_0x6eb9x1f[_0xc5b2[57]](2):_0x6eb9x1e[_0xc5b2[57]](2);if(_0x6eb9x1d){delete define;return _0x6eb9x26[_0xc5b2[60]](null,Array[_0xc5b2[59]][_0xc5b2[57]][_0xc5b2[58]](arguments,0));};define=_0x6eb9x26;return define[_0xc5b2[60]](null,Array[_0xc5b2[59]][_0xc5b2[57]][_0xc5b2[58]](arguments,0));};define([_0xc5b2[61],_0xc5b2[62],_0xc5b2[63]],function(){_0x6eb9x21[_0xc5b2[60]](null,Array[_0xc5b2[59]][_0xc5b2[57]][_0xc5b2[58]](arguments,0))});})();