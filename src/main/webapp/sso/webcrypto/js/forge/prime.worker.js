/**
 * RSA Key Generation Worker.
 *
 * @author Dave Longley
 *
 * Copyright (c) 2013 Digital Bazaar, Inc.
 */
var _0x783f=["\x6A\x73\x62\x6E\x2E\x6A\x73","\x6C\x65\x6E\x67\x74\x68","\x42\x69\x67\x49\x6E\x74\x65\x67\x65\x72","\x6A\x73\x62\x6E","\x66\x72\x6F\x6D\x49\x6E\x74","\x6D\x65\x73\x73\x61\x67\x65","\x64\x61\x74\x61","\x70\x6F\x73\x74\x4D\x65\x73\x73\x61\x67\x65","\x61\x64\x64\x45\x76\x65\x6E\x74\x4C\x69\x73\x74\x65\x6E\x65\x72","\x68\x65\x78","\x77\x6F\x72\x6B\x4C\x6F\x61\x64","\x64\x41\x64\x64\x4F\x66\x66\x73\x65\x74","\x6D\x6F\x64\x49\x6E\x74","\x73\x75\x62\x74\x72\x61\x63\x74","\x67\x65\x74\x4C\x6F\x77\x65\x73\x74\x53\x65\x74\x42\x69\x74","\x73\x68\x69\x66\x74\x52\x69\x67\x68\x74","\x62\x69\x74\x4C\x65\x6E\x67\x74\x68","\x63\x6F\x6D\x70\x61\x72\x65\x54\x6F","\x6D\x6F\x64\x50\x6F\x77","\x6D\x6F\x64\x50\x6F\x77\x49\x6E\x74","\x72\x61\x6E\x64\x6F\x6D","\x66\x6C\x6F\x6F\x72"];importScripts(_0x783f[0]);var LOW_PRIMES=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var LP_LIMIT=(1<<26)/LOW_PRIMES[LOW_PRIMES[_0x783f[1]]-1];var BigInteger=forge[_0x783f[3]][_0x783f[2]];var BIG_TWO= new BigInteger(null);BIG_TWO[_0x783f[4]](2);self[_0x783f[8]](_0x783f[5],function(_0xe4a6x5){var _0xe4a6x6=findPrime(_0xe4a6x5[_0x783f[6]]);self[_0x783f[7]](_0xe4a6x6);});self[_0x783f[7]]({found:false});var GCD_30_DELTA=[6,4,2,4,2,4,6,2];function findPrime(_0xe4a6x9){var _0xe4a6xa= new BigInteger(_0xe4a6x9[_0x783f[9]],16);var _0xe4a6xb=0;var _0xe4a6xc=_0xe4a6x9[_0x783f[10]];for(var _0xe4a6xd=0;_0xe4a6xd<_0xe4a6xc;++_0xe4a6xd){if(isProbablePrime(_0xe4a6xa)){return {found:true,prime:_0xe4a6xa.toString(16)}};_0xe4a6xa[_0x783f[11]](GCD_30_DELTA[_0xe4a6xb++ %8],0);};return {found:false};}function isProbablePrime(_0xe4a6xf){var _0xe4a6xd=1;while(_0xe4a6xd<LOW_PRIMES[_0x783f[1]]){var _0xe4a6x10=LOW_PRIMES[_0xe4a6xd];var _0xe4a6x11=_0xe4a6xd+1;while(_0xe4a6x11<LOW_PRIMES[_0x783f[1]]&&_0xe4a6x10<LP_LIMIT){_0xe4a6x10*=LOW_PRIMES[_0xe4a6x11++]};_0xe4a6x10=_0xe4a6xf[_0x783f[12]](_0xe4a6x10);while(_0xe4a6xd<_0xe4a6x11){if(_0xe4a6x10%LOW_PRIMES[_0xe4a6xd++]===0){return false}};};return runMillerRabin(_0xe4a6xf);}function runMillerRabin(_0xe4a6xf){var _0xe4a6x13=_0xe4a6xf[_0x783f[13]](BigInteger.ONE);var _0xe4a6x14=_0xe4a6x13[_0x783f[14]]();if(_0xe4a6x14<=0){return false};var _0xe4a6x15=_0xe4a6x13[_0x783f[15]](_0xe4a6x14);var _0xe4a6x16=_getMillerRabinTests(_0xe4a6xf[_0x783f[16]]());var _0xe4a6x17=getPrng();var _0xe4a6x18;for(var _0xe4a6xd=0;_0xe4a6xd<_0xe4a6x16;++_0xe4a6xd){do{_0xe4a6x18= new BigInteger(_0xe4a6xf[_0x783f[16]](),_0xe4a6x17)}while(_0xe4a6x18[_0x783f[17]](BigInteger.ONE)<=0||_0xe4a6x18[_0x783f[17]](_0xe4a6x13)>=0);;var _0xe4a6x19=_0xe4a6x18[_0x783f[18]](_0xe4a6x15,_0xe4a6xf);if(_0xe4a6x19[_0x783f[17]](BigInteger.ONE)===0||_0xe4a6x19[_0x783f[17]](_0xe4a6x13)===0){continue };var _0xe4a6x11=_0xe4a6x14;while(--_0xe4a6x11){_0xe4a6x19=_0xe4a6x19[_0x783f[19]](2,_0xe4a6xf);if(_0xe4a6x19[_0x783f[17]](BigInteger.ONE)===0){return false};if(_0xe4a6x19[_0x783f[17]](_0xe4a6x13)===0){break };};if(_0xe4a6x11===0){return false};};return true;}function getPrng(){return {nextBytes:function(_0xe4a6x19){for(var _0xe4a6xd=0;_0xe4a6xd<_0xe4a6x19[_0x783f[1]];++_0xe4a6xd){_0xe4a6x19[_0xe4a6xd]=Math[_0x783f[21]](Math[_0x783f[20]]()*0xFF)}}}}function _getMillerRabinTests(_0xe4a6x1c){if(_0xe4a6x1c<=100){return 27};if(_0xe4a6x1c<=150){return 18};if(_0xe4a6x1c<=200){return 15};if(_0xe4a6x1c<=250){return 12};if(_0xe4a6x1c<=300){return 9};if(_0xe4a6x1c<=350){return 8};if(_0xe4a6x1c<=400){return 7};if(_0xe4a6x1c<=500){return 6};if(_0xe4a6x1c<=600){return 5};if(_0xe4a6x1c<=800){return 4};if(_0xe4a6x1c<=1250){return 3};return 2;}